<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.104.3"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/brainhack_cloud/favicons/favicon.ico><link rel=apple-touch-icon href=/brainhack_cloud/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/brainhack_cloud/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/brainhack_cloud/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/brainhack_cloud/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/brainhack_cloud/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/brainhack_cloud/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/brainhack_cloud/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/brainhack_cloud/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/brainhack_cloud/favicons/android-192x192.png sizes=192x192><title>Virtual machines | Brainhack cloud</title><meta name=description content="Virtual Machines
"><meta property="og:title" content="Virtual machines"><meta property="og:description" content="Virtual Machines
"><meta property="og:type" content="article"><meta property="og:url" content="http://brainhack.org/brainhack_cloud/tutorials/vm/"><meta property="article:section" content="tutorials"><meta property="article:modified_time" content="2022-09-23T17:11:03-04:00"><meta property="og:site_name" content="Brainhack cloud"><meta itemprop=name content="Virtual machines"><meta itemprop=description content="Virtual Machines
"><meta itemprop=dateModified content="2022-09-23T17:11:03-04:00"><meta itemprop=wordCount content="1721"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Virtual machines"><meta name=twitter:description content="Virtual Machines
"><link rel=preload href=/brainhack_cloud/scss/main.min.ac6aa4ebeae7c2e34878b1b842479bebe34635c9dba93329c527f28aef994c87.css as=style><link href=/brainhack_cloud/scss/main.min.ac6aa4ebeae7c2e34878b1b842479bebe34635c9dba93329c527f28aef994c87.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script>
<link rel=stylesheet href=/css/prism.css><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-00000000-0","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/brainhack_cloud/><span class=navbar-logo></span><span class=font-weight-bold>Brainhack cloud</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/brainhack_cloud/tutorials/><span class=active>Tutorials</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/brainhack_cloud/docs/><span>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/brainhack_cloud/admins/><span>Admins</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/brainhackorg/brainhack_cloud target=_blank><i class='fab fa-github'></i><span>GitHub</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://twitter.com/brainhackorg target=_blank><i class='fab fa-twitter'></i><span>News/Twitter</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/brainhack_cloud/offline-search-index.5356bca77919e244d3e2101b1e43909c.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/brainhack_cloud/offline-search-index.5356bca77919e244d3e2101b1e43909c.json data-offline-search-base-href=/ data-offline-search-max-results=10>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-brainhack_cloudtutorials-li><a href=/brainhack_cloud/tutorials/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-brainhack_cloudtutorials><span>Tutorials</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-brainhack_cloudtutorialsvm-li><a href=/brainhack_cloud/tutorials/vm/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-brainhack_cloudtutorialsvm><span class=td-sidebar-nav-active-item>Virtual machines</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-brainhack_cloudtutorialsnotebooks-li><a href=/brainhack_cloud/tutorials/notebooks/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-brainhack_cloudtutorialsnotebooks><span>Notebooks</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-brainhack_cloudtutorialsgh_runner-li><a href=/brainhack_cloud/tutorials/gh_runner/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-brainhack_cloudtutorialsgh_runner><span>Github action runner</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-brainhack_cloudtutorialshpc-li><a href=/brainhack_cloud/tutorials/hpc/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-brainhack_cloudtutorialshpc><span>HPC</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-brainhack_cloudtutorialsneurodesk-li><a href=/brainhack_cloud/tutorials/neurodesk/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-brainhack_cloudtutorialsneurodesk><span>Neurodesk</span></a></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/brainhackorg/brainhack_cloud/tree/main/content/en/tutorials/vm.md class=td-page-meta--view target=_blank rel=noopener><i class="fa fa-file-alt fa-fw"></i> View page source</a>
<a href=https://github.com/brainhackorg/brainhack_cloud/edit/main/content/en/tutorials/vm.md class=td-page-meta--edit target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/brainhackorg/brainhack_cloud/new/main/content/en/tutorials/vm.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class=td-page-meta--child target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/brainhackorg/brainhack_cloud/issues/new?title=Virtual%20machines" class=td-page-meta--issue target=_blank rel=noopener><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/brainhackorg/brainhack_cloud/issues/new class=td-page-meta--project-issue target=_blank rel=noopener><i class="fas fa-tasks fa-fw"></i> Create project issue</a>
<a id=print href=http://brainhack.org/brainhack_cloud/tutorials/_print/><i class="fa fa-print fa-fw"></i> Print entire section</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#setup>Setup</a><ul><li><a href=#selecting-an-image-and-a-shape>Selecting an image and a shape</a></li><li><a href=#connect-to-the-vm-using-the-oracle-key-pair>Connect to the VM using the Oracle key pair</a></li><li><a href=#create-your-own-public-key>Create your own public key</a></li><li><a href=#disk-size>Disk size</a></li><li><a href=#create-the-vm>Create the VM</a></li></ul></li><li><a href=#connect-to-instance>Connect to Instance</a><ul><li><a href=#keeping-a-process-running-even-when-disconnecting>Keeping a process running even when disconnecting:</a></li></ul></li><li><a href=#expand-disk>Expand disk</a></li><li><a href=#increase-disk-size>Increase disk size</a></li><li><a href=#terminate-the-instance>Terminate the instance</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><h1>Virtual machines</h1><div class=lead>Virtual Machines</div><header class=article-meta></header><h2 id=overview>Overview</h2><p>Running a Virtual machine on the Oracle cloud is the basis for many other
things.</p><h2 id=setup>Setup</h2><p>Make sure you selected the geographic region where you would like to create the
resource.</p><p>Here I create it in the Home Region, Frankfurt.</p><div class="alert alert-warning" role=alert><h4 class=alert-heading>Notice</h4>Ideally, you want the region to be as close to you (or your users) as possible to have low latencies. So, you should change the default from Frankfurt to another region from the list.</div><p><img src=https://user-images.githubusercontent.com/4021595/157349780-69fdf973-d4aa-4850-9f49-8ecca369f399.png alt=image></p><p>Head to <code>Compute -> Instances</code></p><p><img src=https://user-images.githubusercontent.com/4021595/157349177-12c719c9-0285-489f-9e42-9d6b82b520c0.png alt=image></p><p>Check that you selected YOUR project compartment (testproject, is the example
here - but you need to change this!) and click <code>Create Instance</code></p><p><img src=https://user-images.githubusercontent.com/4021595/157349261-28eb8f1e-44ff-4939-9ec5-af8e1b37b90c.png alt=image></p><h3 id=selecting-an-image-and-a-shape>Selecting an image and a shape</h3><p>You can name the instance and then select an Image (Oracle Linux is a good
starting point as it has many tools installed that make it work very well on the
Cloud) and select a Shape.</p><p><img src=https://user-images.githubusercontent.com/4021595/157349502-ac932a4e-82b1-410e-8785-56e6e9ae147b.png alt=image></p><p>VM.Standard.E4.Flex is a good starting point.</p><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4>The default is Ampere and this is an ARM architecture, so most of your applications wouldn&rsquo;t work out of the box - it is therefore important to change the default Shape to an x86 architecture, like the VM.Standard.E4.Flex.</div><p><img src=https://user-images.githubusercontent.com/4021595/157349484-eff7d3ec-3f5d-4a6d-b020-a93e63d30745.png alt=image></p><p>The network setup has sensible defaults to start with</p><p><img src=https://user-images.githubusercontent.com/4021595/157349579-b23e4815-2b65-44f9-9f46-53b496b60425.png alt=image></p><p>You can either paste a public key you already have to access to this VM or create a key by choosing the option <code>Generate a key pair for me</code> under <code>Add SSH Keys</code> section.</p><h3 id=connect-to-the-vm-using-the-oracle-key-pair>Connect to the VM using the Oracle key pair</h3><p>If you would like to use the key pairs the instance creation procedure generates, you can use the following steps based on your operating system.</p><p>First download and install an SSH client to your machine (for Linux and Mac, use <a href="https://www.ibm.com/links?url=https%3A%2F%2Fwww.openssh.com%2F">OpenSSH</a> and for Windows use <a href="https://www.ibm.com/links?url=https%3A%2F%2Fwww.putty.org%2F">Putty</a>).</p><p>From the Instances dashboard, find your VM you would like to connect with ssh, and click to find and note its Public IP address.</p><p>If you are using Linux or Mac, run the following command on your local terminal to change the file permission on the private key file that you downloaded from the Oracle dashboard.</p><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4>If you chose the option <code>generate a key pair for me</code> you need to change the permission on the file after downloading - otherwise it will result in a Permission denied (publickey,gssapi-keyex,gssapi-with-mic) error triggered by <code>Load key "*.key": bad permissions</code></div><p><code>chmod 600 /path/privateKeyFileName</code></p><p>Then Run the below command to access the VM via SSH by pasting the IP address of the VM you created.</p><p><code>ssh opc@IPADDRESS -i /path/privateKeyFileName</code></p><p>If you are using Windows use the PuTTY Key Gen generator to generate a PuTTY Private Key file (.ppk).</p><p>Open the PuTTY Keygen Generator.</p><p>Load the downloaded private key file to the PuTTY Generator.</p><p>Enter a phasephrase if you prefer to secure the private key to the <code>Key passpphrase</code> and <code>Confirm passphrase</code> fields, otherwise leave these as empty.</p><p>Then click <code>Save private key</code> to save the private key file it produces.</p><p>Go to your local command line (PowerShell) and connect to your VM with the below command</p><p><code>putty -i C:\Path\privateKey.ppk opc@IPADDRESS</code>.</p><p>Now you are good to go!</p><h3 id=create-your-own-public-key>Create your own public key</h3><p>If you don&rsquo;t have a public key yet - this is how you can create one (for example in
the cloudshell)</p><p>Open the Cloud Shell (this will take a few seconds the first time)</p><p><img src=https://user-images.githubusercontent.com/4021595/157349825-f77d4e77-aba9-4578-beb8-fde536332d5b.png alt=image></p><p>Run <code>ssh-keygen</code> to create private/public key pairs (the defaults are sensible,
so just hit <code>Enter</code> a few times)</p><p><img src=https://user-images.githubusercontent.com/4021595/157350101-0b01d89a-f839-473d-8d6e-6c312e1cfb16.png alt=image></p><p>Now print the public key with <code>cat ~/.ssh/id_rsa.pub</code> and copy it to the
clipboard.</p><p><img src=https://user-images.githubusercontent.com/4021595/157350191-67f4bc21-5c62-4b28-b2e0-3076cec65c60.png alt=image></p><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4>Never share the private key with anyone, which is in <code>id_rsa</code>!</div><p>Paste it in the Add SSH keys section</p><p><img src=https://user-images.githubusercontent.com/4021595/157350315-ee920db6-0bf2-45de-9dd3-3f96c9bbc8fc.png alt=image></p><h3 id=disk-size>Disk size</h3><p>You can specify a custom boot volume size, but you can also increase this
later (described below).</p><p><strong>Note:</strong> it&rsquo;s not possible to shrink a volume! Only increasing the size is
possible, so start small and increase when needed. Increasing the size is even possible while the instance is running and will not interrupt your work :)</p><p>The rest of the defaults are
sensible.</p><p><img src=https://user-images.githubusercontent.com/4021595/157350468-7eac6e01-bbc7-48e3-9fbd-fc0ac01b2476.png alt=image></p><h3 id=create-the-vm>Create the VM</h3><p>This will now create the machine.</p><p><img src=https://user-images.githubusercontent.com/4021595/157350580-aaf564d0-8619-4122-82be-12bce8b3c47d.png alt=image></p><h2 id=connect-to-instance>Connect to Instance</h2><p>You can now use an SSH client on your computer to connect to the Instance, or
the cloudshell.</p><p>You find the connection details in.</p><p><img src=https://user-images.githubusercontent.com/4021595/157351454-d888fd88-130b-40fe-986f-46e451d569ae.png alt=image></p><p>So in this case you would connect to your instance by typing.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh opc@130.61.212.59
</span></span></code></pre></div><p>If you are planning on running web services on the instance (like a jupyter notebook service) - then it&rsquo;s easiest to connect to the instance via a port forwarding and then opening the web service in your local browser at localhost:portnumber.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh -L portnumber:127.0.0.1:portnumber opc@130.61.212.59
</span></span></code></pre></div><p>Accept the fingerprint and you should be connected.</p><p><img src=https://user-images.githubusercontent.com/4021595/157351631-ea6d6e0e-bf8c-4816-99bd-b92b89b033cd.png alt=image></p><h3 id=keeping-a-process-running-even-when-disconnecting>Keeping a process running even when disconnecting:</h3><p>For this you can use tmux:
install tmux with:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo yum install tmux
</span></span></code></pre></div><p>then start a tmux session with:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>tmux
</span></span></code></pre></div><p>then run whatever process or tool you need</p><p>you can disconnect from tmux by hitting CTRL-B and then d. Then you can disconnect from your SSH session (and this also happens when for example your internet connection gets disconnected).</p><p>you can reconnect to the tmux session using:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>tmux a
</span></span></code></pre></div><h2 id=expand-disk>Expand disk</h2><p>By default, the instance will not utilize the whole disk size!</p><p>You can check with <code>df -h</code>.</p><p><img src=https://user-images.githubusercontent.com/4021595/157351914-38855be5-9b2a-4883-bfc4-768890fd1f8e.png alt=image></p><p>But it can expand the disk with the following commands.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo dd <span style=color:#000>iflag</span><span style=color:#ce5c00;font-weight:700>=</span>direct <span style=color:#204a87;font-weight:700>if</span><span style=color:#ce5c00;font-weight:700>=</span>/dev/oracleoci/oraclevda <span style=color:#000>of</span><span style=color:#ce5c00;font-weight:700>=</span>/dev/null <span style=color:#000>count</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span><span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;1&#34;</span> <span style=color:#000;font-weight:700>|</span> sudo tee /sys/class/block/<span style=color:#4e9a06>`</span>readlink /dev/oracleoci/oraclevda <span style=color:#000;font-weight:700>|</span> cut -d<span style=color:#4e9a06>&#39;/&#39;</span> -f 2<span style=color:#4e9a06>`</span>/device/rescan
</span></span><span style=display:flex><span>sudo /usr/libexec/oci-growfs -y
</span></span></code></pre></div><p>If you are not using an Oracle Linux image, then oci-growfs will not be installed. You can create the script manually by copying this:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># oci-utils</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Copyright (c) 2018, 2020 Oracle and/or its affiliates. All rights reserved.</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Licensed under the Universal Permissive License v 1.0 as shown at http://oss.oracle.com/licenses/upl.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>ASSUME_YES</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>0</span>
</span></span><span style=display:flex><span><span style=color:#000>ASSUME_NO</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Print usage message</span>
</span></span><span style=display:flex><span>usage<span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>cat <span style=color:#4e9a06>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>Usage: $0 [OPTION]
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>Expand the root filesystem to its configured size.
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>Option:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  -y                           Assume &#34;yes&#34; for all questions.
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  -n                           Assume &#34;n&#34; to all questions (used for preview).
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  -h                           Print this message.
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Prompt for action confirmation</span>
</span></span><span style=display:flex><span>confirm<span style=color:#ce5c00;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>[</span> <span style=color:#4e9a06>${</span><span style=color:#000>ASSUME_YES</span><span style=color:#4e9a06>}</span> -eq <span style=color:#0000cf;font-weight:700>1</span> <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> <span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>0</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>[</span> <span style=color:#4e9a06>${</span><span style=color:#000>ASSUME_NO</span><span style=color:#4e9a06>}</span> -eq <span style=color:#0000cf;font-weight:700>1</span> <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> <span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>while</span> <span style=color:#204a87>true</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>do</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic># force use of a tty, if we are inside a &#39;read loop&#39; already the prompt is never display and we loop forever</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>read</span> -p <span style=color:#4e9a06>&#34;Confirm? [y/n]&#34;</span> input &lt; /dev/tty
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>case</span> <span style=color:#4e9a06>${</span><span style=color:#000>input</span><span style=color:#4e9a06>}</span> in
</span></span><span style=display:flex><span>            <span style=color:#ce5c00;font-weight:700>[</span>yY<span style=color:#ce5c00;font-weight:700>][</span>eE<span style=color:#ce5c00;font-weight:700>][</span>sS<span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>|</span><span style=color:#ce5c00;font-weight:700>[</span>yY<span style=color:#ce5c00;font-weight:700>])</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>return</span> 0<span style=color:#000;font-weight:700>;;</span>
</span></span><span style=display:flex><span>            <span style=color:#ce5c00;font-weight:700>[</span>nN<span style=color:#ce5c00;font-weight:700>][</span>oO<span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>|</span><span style=color:#ce5c00;font-weight:700>[</span>nN<span style=color:#ce5c00;font-weight:700>])</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>return</span> 1<span style=color:#000;font-weight:700>;;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>esac</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>done</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>part_growfs_preview<span style=color:#ce5c00;font-weight:700>(){</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>[</span> <span style=color:#000>$#</span> -ne <span style=color:#0000cf;font-weight:700>2</span> <span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>;</span> <span style=color:#204a87;font-weight:700>then</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;Invalid disk or partition.&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>exit</span> <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    growpart <span style=color:#000>$1</span> <span style=color:#000>$2</span> --dry-run
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>$?</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>part_growfs_func<span style=color:#ce5c00;font-weight:700>(){</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>[</span> <span style=color:#000>$#</span> -ne <span style=color:#0000cf;font-weight:700>2</span> <span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>;</span> <span style=color:#204a87;font-weight:700>then</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;Invalid disk or partition.&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>exit</span> <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    growpart <span style=color:#000>$1</span> <span style=color:#000>$2</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>[</span> <span style=color:#000>$?</span> -eq <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>then</span>
</span></span><span style=display:flex><span>        xfs_growfs /
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>fi</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>$?</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>[</span> <span style=color:#4e9a06>&#34;</span><span style=color:#000>$EUID</span><span style=color:#4e9a06>&#34;</span> -ne <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>;</span> <span style=color:#204a87;font-weight:700>then</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;This script needs root privileges to execute.&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87>exit</span> <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>while</span> <span style=color:#ce5c00;font-weight:700>[</span> <span style=color:#4e9a06>&#34;</span><span style=color:#000>$#</span><span style=color:#4e9a06>&#34;</span> -gt <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>;</span> <span style=color:#204a87;font-weight:700>do</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>case</span> <span style=color:#4e9a06>&#34;</span><span style=color:#000>$1</span><span style=color:#4e9a06>&#34;</span> in
</span></span><span style=display:flex><span>    -n<span style=color:#000;font-weight:700>|</span>-N<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000>ASSUME_NO</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>break</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>;;</span>
</span></span><span style=display:flex><span>    -y<span style=color:#000;font-weight:700>|</span>-Y<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000>ASSUME_YES</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>break</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>;;</span>
</span></span><span style=display:flex><span>    -h<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        usage
</span></span><span style=display:flex><span>        <span style=color:#204a87>exit</span> <span style=color:#0000cf;font-weight:700>0</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>;;</span>
</span></span><span style=display:flex><span>    -* <span style=color:#000;font-weight:700>|</span> *<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;unknown option: </span><span style=color:#000>$1</span><span style=color:#4e9a06>&#34;</span> &gt;<span style=color:#000;font-weight:700>&amp;</span>2<span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>        usage<span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>exit</span> <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>;;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>esac</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>done</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># first get storage type used for root FS</span>
</span></span><span style=display:flex><span><span style=color:#000>_storage</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>`</span>/usr/bin/findmnt --canonicalize --noheadings --output SOURCE /<span style=color:#4e9a06>`</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># expecting lvm or part,</span>
</span></span><span style=display:flex><span>/usr/bin/lsblk --noheadings -o TYPE,NAME <span style=color:#000>$_storage</span> <span style=color:#000;font-weight:700>|</span> <span style=color:#204a87;font-weight:700>while</span> <span style=color:#204a87>read</span> _type _sto
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>do</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>case</span> <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>_type</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> in
</span></span><span style=display:flex><span>        part<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>            part_growfs_preview /dev/<span style=color:#4e9a06>${</span><span style=color:#000>_sto</span><span style=color:#000;font-weight:700>//[0-9]/</span><span style=color:#4e9a06>}</span> <span style=color:#4e9a06>${</span><span style=color:#000>_sto</span><span style=color:#000;font-weight:700>//[^0-9]/</span><span style=color:#4e9a06>}</span> <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#204a87>exit</span> <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>            confirm
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>[</span> <span style=color:#000>$?</span> -eq <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>then</span>
</span></span><span style=display:flex><span>                part_growfs_func /dev/<span style=color:#4e9a06>${</span><span style=color:#000>_sto</span><span style=color:#000;font-weight:700>//[0-9]/</span><span style=color:#4e9a06>}</span> <span style=color:#4e9a06>${</span><span style=color:#000>_sto</span><span style=color:#000;font-weight:700>//[^0-9]/</span><span style=color:#4e9a06>}</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87>exit</span> <span style=color:#000>$?</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>else</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87>exit</span> <span style=color:#0000cf;font-weight:700>0</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>fi</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>;;</span>
</span></span><span style=display:flex><span>        lvm<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>            <span style=color:#8f5902;font-style:italic># 1. find LV and VG of the device</span>
</span></span><span style=display:flex><span>            <span style=color:#8f5902;font-style:italic>#     we pipe to  awk  to strip away any leading space</span>
</span></span><span style=display:flex><span>            <span style=color:#000>_root_vg</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>`</span>/usr/sbin/lvs --noheadings --options vg_name --select <span style=color:#000>lv_dm_path</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>$_storage</span> <span style=color:#000;font-weight:700>|</span> awk <span style=color:#4e9a06>&#39;{print $1}&#39;</span><span style=color:#4e9a06>`</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;root VG: </span><span style=color:#4e9a06>${</span><span style=color:#000>_root_vg</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#ce5c00;font-weight:700>[</span> <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>_root_vg</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#4e9a06>&#34;&#34;</span> <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> <span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;Cannot find root volume group.&#34;</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> <span style=color:#204a87>exit</span> <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#8f5902;font-style:italic># 2. find all PVs involve in the VG used for root</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>for</span> _pv in <span style=color:#4e9a06>`</span>/usr/sbin/pvs --noheadings --options pv_name --select <span style=color:#000>vg_name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>${</span><span style=color:#000>_root_vg</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>`</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>do</span>
</span></span><span style=display:flex><span>                <span style=color:#8f5902;font-style:italic># 3. find device of PVs</span>
</span></span><span style=display:flex><span>                <span style=color:#000>_device</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>`</span>/usr/sbin/pvs --noheadings --options devices --select <span style=color:#000>pv_name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>${</span><span style=color:#000>_pv</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>`</span>
</span></span><span style=display:flex><span>                <span style=color:#8f5902;font-style:italic># device is suffixed with extne number like /dev/sda3(0) , just keep disk information parts</span>
</span></span><span style=display:flex><span>                <span style=color:#000>_device</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>${</span><span style=color:#000>_device</span><span style=color:#000;font-weight:700>//([0-9]*)/</span><span style=color:#4e9a06>}</span>
</span></span><span style=display:flex><span>                <span style=color:#8f5902;font-style:italic># 3.1 extend the partittion</span>
</span></span><span style=display:flex><span>                part_growfs_preview <span style=color:#4e9a06>${</span><span style=color:#000>_device</span><span style=color:#000;font-weight:700>//[0-9]/</span><span style=color:#4e9a06>}</span> <span style=color:#4e9a06>${</span><span style=color:#000>_device</span><span style=color:#000;font-weight:700>//[^0-9]/</span><span style=color:#4e9a06>}</span> <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#204a87>exit</span> <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>                confirm
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>[</span> <span style=color:#000>$?</span> -eq <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>then</span>
</span></span><span style=display:flex><span>                    <span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;calling part_growfs_func </span><span style=color:#4e9a06>${</span><span style=color:#000>_device</span><span style=color:#000;font-weight:700>//[0-9]/</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06> </span><span style=color:#4e9a06>${</span><span style=color:#000>_device</span><span style=color:#000;font-weight:700>//[^0-9]/</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span>
</span></span><span style=display:flex><span>                    part_growfs_func <span style=color:#4e9a06>${</span><span style=color:#000>_device</span><span style=color:#000;font-weight:700>//[0-9]/</span><span style=color:#4e9a06>}</span> <span style=color:#4e9a06>${</span><span style=color:#000>_device</span><span style=color:#000;font-weight:700>//[^0-9]/</span><span style=color:#4e9a06>}</span>
</span></span><span style=display:flex><span>                    <span style=color:#ce5c00;font-weight:700>[</span> <span style=color:#000>$?</span> !<span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> <span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;Cannot extend physical volume disk partition.&#34;</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> <span style=color:#204a87>exit</span> <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>else</span>
</span></span><span style=display:flex><span>                    <span style=color:#204a87>exit</span> <span style=color:#0000cf;font-weight:700>0</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>fi</span>
</span></span><span style=display:flex><span>                <span style=color:#8f5902;font-style:italic># 3.1 extend the PV</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;calling /usr/sbin/pvresize </span><span style=color:#4e9a06>${</span><span style=color:#000>_pv</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span>
</span></span><span style=display:flex><span>                /usr/sbin/pvresize <span style=color:#4e9a06>${</span><span style=color:#000>_pv</span><span style=color:#4e9a06>}</span>
</span></span><span style=display:flex><span>                <span style=color:#ce5c00;font-weight:700>[</span> <span style=color:#000>$?</span> !<span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> <span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;Cannot extend physical volume.&#34;</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> <span style=color:#204a87>exit</span> <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>done</span>
</span></span><span style=display:flex><span>            <span style=color:#8f5902;font-style:italic># 4. extend the LV and the FS</span>
</span></span><span style=display:flex><span>            <span style=color:#000>_lv_path</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>`</span>/usr/sbin/lvs --noheadings --options lv_path --select <span style=color:#000>lv_dm_path</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>$_storage</span><span style=color:#4e9a06>`</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;calling /usr/sbin/lvextend -l +100%FREE --resizefs </span><span style=color:#4e9a06>${</span><span style=color:#000>_lv_path</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span>
</span></span><span style=display:flex><span>            /usr/sbin/lvextend -l +100%FREE --resizefs <span style=color:#4e9a06>${</span><span style=color:#000>_lv_path</span><span style=color:#4e9a06>}</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87>exit</span> <span style=color:#000>$?</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>esac</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>done</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87>exit</span> <span style=color:#000>$?</span>
</span></span></code></pre></div><p>into <code>/usr/libexec/oci-growfs</code> by doing this:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo vi /usr/libexec/oci-growfs
</span></span><span style=display:flex><span># hit i to activate insert mode, then paste, then hit SHIFT-Z-Z to exit and save
</span></span><span style=display:flex><span>sudo chmod a+x /usr/libexec/oci-growfs
</span></span></code></pre></div><p>then execute the expansion command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo dd iflag=direct if=/dev/oracleoci/oraclevda of=/dev/null count=1
</span></span><span style=display:flex><span>echo &#34;1&#34; | sudo tee /sys/class/block/`readlink /dev/oracleoci/oraclevda | cut -d&#39;/&#39; -f 2`/device/rescan
</span></span><span style=display:flex><span>sudo /usr/libexec/oci-growfs -y
</span></span></code></pre></div><p><img src=https://user-images.githubusercontent.com/4021595/157352261-3d30774a-4052-4e12-846a-133f4f8ffa98.png alt=image></p><p>Now it&rsquo;s using the full volume.</p><p><img src=https://user-images.githubusercontent.com/4021595/157352396-a3a4a3a9-38a7-49d5-a18b-880c058bbc2d.png alt=image></p><h2 id=increase-disk-size>Increase disk size</h2><p>If you want to increase the disk space beyond the size that you initially set you need to first change the disk size in OCI. You can do this while the instance is running! Go to the instance and select Boot volume from the menu on the left:</p><img width=1052 alt=image src=https://user-images.githubusercontent.com/4021595/187821034-f59296a2-d386-497d-8a4c-2c84edc577ec.png><p>Then click on the boot volume name and click the <code>Edit</code> button:</p><img width=958 alt=image src=https://user-images.githubusercontent.com/4021595/187821085-525e9ade-a8ce-4f36-ab0b-a3e9648137d8.png><p>Now set the desired size and click <code>Save Changes</code>:</p><img width=691 alt=image src=https://user-images.githubusercontent.com/4021595/187821161-24099d27-8218-4907-9ade-7f18d93ee0c6.png><p>Then login to the instance and expand the disk again to the new size:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo dd <span style=color:#000>iflag</span><span style=color:#ce5c00;font-weight:700>=</span>direct <span style=color:#204a87;font-weight:700>if</span><span style=color:#ce5c00;font-weight:700>=</span>/dev/oracleoci/oraclevda <span style=color:#000>of</span><span style=color:#ce5c00;font-weight:700>=</span>/dev/null <span style=color:#000>count</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span><span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;1&#34;</span> <span style=color:#000;font-weight:700>|</span> sudo tee /sys/class/block/<span style=color:#4e9a06>`</span>readlink /dev/oracleoci/oraclevda <span style=color:#000;font-weight:700>|</span> cut -d<span style=color:#4e9a06>&#39;/&#39;</span> -f 2<span style=color:#4e9a06>`</span>/device/rescan
</span></span><span style=display:flex><span>sudo /usr/libexec/oci-growfs -y
</span></span></code></pre></div><h2 id=terminate-the-instance>Terminate the instance</h2><p>If you don&rsquo;t need the machine anymore, you can <code>Stop</code> it (you don&rsquo;t pay for the compute anymore, but the disk stays and you can start it back up later) or <code>Terminate</code> it (everything gets removed, including the boot volume if you want to):</p><p><img src=https://user-images.githubusercontent.com/4021595/157352624-f3b2b358-1f3d-4388-bf2f-6fc417d4a439.png alt=image></p><p>To cleanup the storage as well, you can select
<code>Permanently delete the attached boot volume</code> and click <code>Terminate Instance</code>.</p><p><img src=https://user-images.githubusercontent.com/4021595/157352698-9788c610-b5f1-43bf-95e7-ca444e8813fb.png alt=image></p><p>If you aim to update the version of the Python that comes as default with VM or install environment you could install Miniconda by following below commands:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>
</span></span><span style=display:flex><span>curl -o /tmp/miniconda.sh https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh; 
</span></span><span style=display:flex><span>bash /tmp/miniconda.sh -b;
</span></span><span style=display:flex><span>miniconda3/bin/conda init
</span></span></code></pre></div><p>this installation will give you all the necessary packages to start with building your own environment and project.</p><div class="text-muted mt-5 pt-3 border-top">Last modified September 23, 2022: <a href=https://github.com/brainhackorg/brainhack_cloud/commit/870d91cc88964af76daab76754e4f58970e75a73>Add Miniconda instructions (870d91c)</a></div></div></main></div></div><footer class="bg-dark py-4 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2 my-auto"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label><a class=text-white target=_blank rel=noopener href aria-label><i></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://twitter.com/brainhackorg aria-label=Twitter><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label><a class=text-white target=_blank rel=noopener href aria-label><i></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3 my-auto"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/brainhackorg/brainhack_cloud aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label><a class=text-white target=_blank rel=noopener href aria-label><i></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Dicussion Forum (requires github login)" aria-label="Dicussion Forum (requires github login)"><a class=text-white target=_blank rel=noopener href=https://github.com/brainhackorg/brainhack_cloud/discussions aria-label="Dicussion Forum (requires github login)"><i class="fa fa-envelope"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2 my-auto"><small class=text-white>&copy; 2022 Brainhack Cloud<br>Except where otherwise noted, content on this site is licensed under a <a href=https://creativecommons.org/licenses/by/4.0/>CC BY 4.0 license</a>.</small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/brainhack_cloud/js/main.min.0d626687ffb089f2a85c2441d596cc7e2218d32716e3a26b4623c159ada50846.js integrity="sha256-DWJmh/+wifKoXCRB1ZbMfiIY0ycW46JrRiPBWa2lCEY=" crossorigin=anonymous></script>
<script src=/js/prism.js></script></body></html>