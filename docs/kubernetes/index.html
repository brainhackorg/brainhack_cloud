<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.121.0"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/brainhack_cloud/favicons/favicon.ico><link rel=apple-touch-icon href=/brainhack_cloud/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/brainhack_cloud/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/brainhack_cloud/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/brainhack_cloud/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/brainhack_cloud/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/brainhack_cloud/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/brainhack_cloud/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/brainhack_cloud/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/brainhack_cloud/favicons/android-192x192.png sizes=192x192><title>Kubernetes | Brainhack cloud</title>
<meta name=description content="A description how to get started with Kubernetes on Oracle Cloud"><meta property="og:title" content="Kubernetes"><meta property="og:description" content="A description how to get started with Kubernetes on Oracle Cloud"><meta property="og:type" content="article"><meta property="og:url" content="http://brainhack.org/brainhack_cloud/docs/kubernetes/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2022-04-21T17:40:16+10:00"><meta itemprop=name content="Kubernetes"><meta itemprop=description content="A description how to get started with Kubernetes on Oracle Cloud"><meta itemprop=dateModified content="2022-04-21T17:40:16+10:00"><meta itemprop=wordCount content="365"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Kubernetes"><meta name=twitter:description content="A description how to get started with Kubernetes on Oracle Cloud"><link rel=preload href=/brainhack_cloud/scss/main.min.378881a835657c97b8501be32d5af0b3a9939c7c4dafd975b0a1de3c0789c3d5.css as=style><link href=/brainhack_cloud/scss/main.min.378881a835657c97b8501be32d5af0b3a9939c7c4dafd975b0a1de3c0789c3d5.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script><script src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script><link rel=stylesheet href=/css/prism.css><script>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-00000000-0","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/brainhack_cloud/><span class=navbar-logo></span><span class=font-weight-bold>Brainhack cloud</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/brainhack_cloud/tutorials/><span>Tutorials</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/brainhack_cloud/docs/><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/brainhack_cloud/admins/><span>Admins</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/brainhackorg/brainhack_cloud target=_blank><i class='fab fa-github'></i><span>GitHub</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://twitter.com/brainhackorg target=_blank><i class='fab fa-twitter'></i><span>News/Twitter</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/brainhack_cloud/offline-search-index.a4c9f7342cc9f1b12f466147e4f6ff61.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/brainhack_cloud/offline-search-index.a4c9f7342cc9f1b12f466147e4f6ff61.json data-offline-search-base-href=/ data-offline-search-max-results=10>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-brainhack_clouddocs-li><a href=/brainhack_cloud/docs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-brainhack_clouddocs><span>Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-brainhack_clouddocsrequest-li><a href=/brainhack_cloud/docs/request/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-brainhack_clouddocsrequest><span>Requesting Cloud Resources</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-brainhack_clouddocsobject_storage-li><a href=/brainhack_cloud/docs/object_storage/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-brainhack_clouddocsobject_storage><span>Object Storage</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-brainhack_clouddocstenancy_explorer-li><a href=/brainhack_cloud/docs/tenancy_explorer/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-brainhack_clouddocstenancy_explorer><span>Tenancy Explorer</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-brainhack_clouddocsdocker-li><a href=/brainhack_cloud/docs/docker/ title="Installing and Using Docker" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-brainhack_clouddocsdocker><span>Docker</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-brainhack_clouddocskubernetes-li><a href=/brainhack_cloud/docs/kubernetes/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-brainhack_clouddocskubernetes><span class=td-sidebar-nav-active-item>Kubernetes</span></a></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/brainhackorg/brainhack_cloud/tree/main/content/en/docs/kubernetes.md class=td-page-meta--view target=_blank rel=noopener><i class="fa fa-file-alt fa-fw"></i> View page source</a>
<a href=https://github.com/brainhackorg/brainhack_cloud/edit/main/content/en/docs/kubernetes.md class=td-page-meta--edit target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/brainhackorg/brainhack_cloud/new/main/content/en/docs/kubernetes.md?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class=td-page-meta--child target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/brainhackorg/brainhack_cloud/issues/new?title=Kubernetes" class=td-page-meta--issue target=_blank rel=noopener><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/brainhackorg/brainhack_cloud/issues/new class=td-page-meta--project-issue target=_blank rel=noopener><i class="fas fa-tasks fa-fw"></i> Create project issue</a>
<a id=print href=http://brainhack.org/brainhack_cloud/docs/_print/><i class="fa fa-print fa-fw"></i> Print entire section</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#setup-kubernetes-cluster-on-oracle-cloud-using-oke>Setup Kubernetes Cluster on Oracle Cloud using OKE</a></li><li><a href=#customizing-nodes-using-init-scripts>Customizing nodes using Init-scripts</a></li><li><a href=#cleanup>Cleanup</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><h1>Kubernetes</h1><div class=lead>A description how to get started with Kubernetes on Oracle Cloud</div><header class=article-meta></header><h2 id=overview>Overview</h2><p>Kubernetes enables running and orchestrating multiple software containers.</p><h2 id=setup-kubernetes-cluster-on-oracle-cloud-using-oke>Setup Kubernetes Cluster on Oracle Cloud using OKE</h2><p>Search for <code>OKE</code> in the menu and then go to <code>Kubernetes Clusters (OKE)</code> under <code>Containers & Artifacts</code>:
<img src=https://user-images.githubusercontent.com/4021595/164392430-231652d9-abf3-4cc0-ac90-4b2dd5c000ea.png alt=image></p><p>Select the region where you would like to create the Cluster:
<img src=https://user-images.githubusercontent.com/4021595/164392545-765fc2bd-50c1-460f-9615-213b81d3ae54.png alt=image></p><p>Select the compartment where you would like to create the Cluster:
<img src=https://user-images.githubusercontent.com/4021595/164392623-6bfc0561-7d6c-4e32-aa70-fef8259961bc.png alt=image></p><p><code>Quick Create</code> is great and gives a good starting point that works for most applications:
<img src=https://user-images.githubusercontent.com/4021595/164392731-1f23834c-9be3-40f8-b2c9-24ea65c13fc4.png alt=image></p><p>The defaults are sensible, but Public Workers make it easier to troubleshoot things in the beginning:
<img src=https://user-images.githubusercontent.com/4021595/164392860-eb050636-e820-46e2-a98a-cfdaf45a9281.png alt=image></p><p>Select the shape you like and 1 worker is good to start (can be increased and changed later!)
<img src=https://user-images.githubusercontent.com/4021595/164393030-561bf2d1-1af2-408b-9e38-51802efdd976.png alt=image></p><p>Under advanced you can configure the boot-volume size:
<img src=https://user-images.githubusercontent.com/4021595/164393130-65e48e2e-605f-4d6f-9fe3-78518fba0d14.png alt=image></p><p>Add an SSH key for troubleshooting worker nodes:
<img src=https://user-images.githubusercontent.com/4021595/164393220-77da1837-5407-476c-a971-1b3dc69b3d14.png alt=image></p><p>Review everything and then hit <code>Create</code> and it should go and set-up everything :)
<img src=https://user-images.githubusercontent.com/4021595/164393349-2b34f99a-5ea0-462e-95c4-4dd2f6d7c16e.png alt=image></p><p>That&rsquo;s how easy it can be to setup a whole Kubernetes cluster :) Thanks OCI team for creating OKE!
<img src=https://user-images.githubusercontent.com/4021595/164393450-1abc92f1-7dad-4e77-a5b5-0c72e7b0c08f.png alt=image></p><p>It will take a few minutes until everything is up and running -> Coffee break?</p><p>Once everything is ready:
<img src=https://user-images.githubusercontent.com/4021595/164396586-28f044db-f7fa-45f9-a454-ce47b41b3255.png alt=image></p><p>you can access the cluster and the settings are given when clicking <code>Access Cluster</code>:
<img src=https://user-images.githubusercontent.com/4021595/164396652-d56916ae-c822-4a03-a0de-471ffc550599.png alt=image></p><h2 id=customizing-nodes-using-init-scripts>Customizing nodes using Init-scripts</h2><p>If you configured Public IP addresses for the worker nodes, then you can connect to the nodes for troubleshooting - Click on the node under <code>Nodes</code> -> <code>pool1</code>:
<img src=https://user-images.githubusercontent.com/4021595/164403035-67eebf45-82a2-4627-8461-457e63ad0468.png alt=image></p><p>By default the disks are NOT expanded to the Bootvolume size you configured, so this can be fixed via init scripts. Edit the node pool and under advanced set the inits script:
<img src=https://user-images.githubusercontent.com/4021595/164403545-b43aca42-6185-4713-8faa-0a02762ad5b7.png alt=image></p><p>This script will expand the disk:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>curl --fail -H <span style=color:#4e9a06>&#34;Authorization: Bearer Oracle&#34;</span> -L0 http://169.254.169.254/opc/v2/instance/metadata/oke_init_script <span style=color:#000;font-weight:700>|</span> base64 --decode &gt;/var/run/oke-init.sh
</span></span><span style=display:flex><span>bash /var/run/oke-init.sh
</span></span><span style=display:flex><span>sudo dd <span style=color:#000>iflag</span><span style=color:#ce5c00;font-weight:700>=</span>direct <span style=color:#204a87;font-weight:700>if</span><span style=color:#ce5c00;font-weight:700>=</span>/dev/oracleoci/oraclevda <span style=color:#000>of</span><span style=color:#ce5c00;font-weight:700>=</span>/dev/null <span style=color:#000>count</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span><span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;1&#34;</span> <span style=color:#000;font-weight:700>|</span> sudo tee /sys/class/block/<span style=color:#4e9a06>`</span>readlink /dev/oracleoci/oraclevda <span style=color:#000;font-weight:700>|</span> cut -d<span style=color:#4e9a06>&#39;/&#39;</span> -f 2<span style=color:#4e9a06>`</span>/device/rescan
</span></span><span style=display:flex><span>sudo /usr/libexec/oci-growfs -y
</span></span></code></pre></div><p>Then hit <code>Save Changes</code>. To apply these configuration changes you need to Scale the pool to 0 and then backup to 1:
<img src=https://user-images.githubusercontent.com/4021595/164403744-30b40a8a-1e3a-428d-9a7e-14e7a3414d33.png alt=image></p><h2 id=cleanup>Cleanup</h2><p>You can delete the whole cluster to cleanup:
<img src=https://user-images.githubusercontent.com/4021595/164403933-41d231a9-e157-4dca-b770-e0d903813f8c.png alt=image></p><p>But be aware that Kubernetes can create resources via API calls, which is great, but it also means that these additionally created resources (like load balancers or storage volumes) will NOT be cleaned up automatically and need to cleaned up manually!</p><div class="text-muted mt-5 pt-3 border-top">Last modified April 21, 2022: <a href=https://github.com/brainhackorg/brainhack_cloud/commit/8819d723c08b70175f7d824cca0bdb02ccff2db8>Finalized Kubernetes instructions (8819d72)</a></div></div></main></div></div><footer class="bg-dark py-4 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2 my-auto"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label><a class=text-white target=_blank rel=noopener href aria-label><i></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://twitter.com/brainhackorg aria-label=Twitter><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label><a class=text-white target=_blank rel=noopener href aria-label><i></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3 my-auto"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/brainhackorg/brainhack_cloud aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label><a class=text-white target=_blank rel=noopener href aria-label><i></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Dicussion Forum (requires github login)" aria-label="Dicussion Forum (requires github login)"><a class=text-white target=_blank rel=noopener href=https://github.com/brainhackorg/brainhack_cloud/discussions aria-label="Dicussion Forum (requires github login)"><i class="fa fa-envelope"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2 my-auto"><small class=text-white>&copy; 2023 Brainhack Cloud<br>Except where otherwise noted, content on this site is licensed under a <a href=https://creativecommons.org/licenses/by/4.0/>CC BY 4.0 license</a>.</small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script><script src=/brainhack_cloud/js/main.min.0d626687ffb089f2a85c2441d596cc7e2218d32716e3a26b4623c159ada50846.js integrity="sha256-DWJmh/+wifKoXCRB1ZbMfiIY0ycW46JrRiPBWa2lCEY=" crossorigin=anonymous></script><script src=/js/prism.js></script></body></html>