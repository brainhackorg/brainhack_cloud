<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.117.0"><link rel=canonical type=text/html href=http://brainhack.org/brainhack_cloud/docs/><link rel=alternate type=application/rss+xml href=http://brainhack.org/brainhack_cloud/docs/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/brainhack_cloud/favicons/favicon.ico><link rel=apple-touch-icon href=/brainhack_cloud/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/brainhack_cloud/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/brainhack_cloud/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/brainhack_cloud/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/brainhack_cloud/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/brainhack_cloud/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/brainhack_cloud/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/brainhack_cloud/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/brainhack_cloud/favicons/android-192x192.png sizes=192x192><title>Documentation | Brainhack cloud</title><meta name=description content="Documentation.
"><meta property="og:title" content="Documentation"><meta property="og:description" content="Documentation.
"><meta property="og:type" content="website"><meta property="og:url" content="http://brainhack.org/brainhack_cloud/docs/"><meta itemprop=name content="Documentation"><meta itemprop=description content="Documentation.
"><meta name=twitter:card content="summary"><meta name=twitter:title content="Documentation"><meta name=twitter:description content="Documentation.
"><link rel=preload href=/brainhack_cloud/scss/main.min.378881a835657c97b8501be32d5af0b3a9939c7c4dafd975b0a1de3c0789c3d5.css as=style><link href=/brainhack_cloud/scss/main.min.378881a835657c97b8501be32d5af0b3a9939c7c4dafd975b0a1de3c0789c3d5.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script>
<link rel=stylesheet href=/css/prism.css><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-00000000-0","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/brainhack_cloud/><span class=navbar-logo></span><span class=font-weight-bold>Brainhack cloud</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/brainhack_cloud/tutorials/><span>Tutorials</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/brainhack_cloud/docs/><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/brainhack_cloud/admins/><span>Admins</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/brainhackorg/brainhack_cloud target=_blank><i class='fab fa-github'></i><span>GitHub</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://twitter.com/brainhackorg target=_blank><i class='fab fa-twitter'></i><span>News/Twitter</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/brainhack_cloud/offline-search-index.a4c9f7342cc9f1b12f466147e4f6ff61.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/brainhack_cloud/docs/>Return to the regular view of this page</a>.</p></div><h1 class=title>Documentation</h1><div class=lead>Documentation.</div><ul><li>1: <a href=#pg-750ed50c59d5c909a463e2a246302fd3>Requesting Cloud Resources</a></li><li>2: <a href=#pg-c917c05dab90d67a2e13944aefd1eb9d>Object Storage</a></li><li>3: <a href=#pg-f6f02481d5d016336867b24121bda257>Tenancy Explorer</a></li><li>4: <a href=#pg-dde96463ad5c157f426c31ea5b3bf8d8>Installing and Using Docker</a></li><li>5: <a href=#pg-34f20b9d4a0c4334831e060dbcb10552>Kubernetes</a></li></ul><div class=content><h2 id=overview>Overview</h2><p>This section contains documentation on how to use the Oracle Cloud.</p><h2 id=feedback--inquiries>Feedback & Inquiries</h2><p>To ask questions or suggest new features,
<a href=https://github.com/brainhackorg/brainhack_cloud/discussions>join the discussion</a>
on Github. For issues with the <em>brainhack cloud</em>, please open a
<a href=https://github.com/brainhackorg/brainhack_cloud/issues>new issue</a>.</p><h2 id=acknowledgments>Acknowledgments</h2><h2 id=funding>Funding</h2><p>Thank you to Oracle for Research for providing Oracle Cloud credits and related
resources to support this project.</p><a href="https://www.oracle.com/research/?source=:pp:sn:::::RC_WWMK211117P00113:Evergreen_General_WWMK211117P00113_Sponshorship"><img src=https://user-images.githubusercontent.com/4021595/119061922-db877080-ba18-11eb-9882-d53a25ec88ee.png width=250></a><p>What is Oracle for Research?
&ldquo;Oracle for Research supports academic, educational, and institutional researchers in all aspects of discovery. We’ve made it simple for them to host, store and analyze their data with our cloud infrastructure solutions. Our research customers are changing the world – and we’re proud to help them do it.”</p><h2 id=license>License</h2><p>CC BY License 4.0</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-750ed50c59d5c909a463e2a246302fd3>1 - Requesting Cloud Resources</h1><div class=lead>Requesting Cloud Resources</div><h2 id=request-resources-via-a-github-issue-template>Request resources via a Github Issue Template</h2><ol><li><p>Fill in this
<a href="https://github.com/brainhackorg/brainhack_cloud/issues/new?assignees=&amp;labels=resource_request&amp;template=request-resource-access.yml">form</a>.</p></li><li><p>Once an <a href=https://brainhack.org/brainhack_cloud/admins/team/>admin</a> acts on
this, you can continue.</p></li></ol><h2 id=activate-your-account>Activate your account</h2><p>An admin will create your account and send you a password and you will get an
activation email from Oracle</p><p><img src=https://user-images.githubusercontent.com/4021595/157340745-1d565298-a117-401c-9611-93e051e97853.png alt=image></p><p>Click on the activation link.</p><p>Now, it&rsquo;s very important that you expand the LOWER section of this login field
and fill in your Username from the email and the password you were sent!</p><p><img src=https://user-images.githubusercontent.com/4021595/157340962-3021d25f-31b1-44c0-a30a-130c70ac3327.png alt=image></p><p>Then click on <code>Sign In</code>.</p><p>Then change your password and hit <code>Save New Password</code></p><p><img src=https://user-images.githubusercontent.com/4021595/157341119-90b9d2e6-d06f-4659-a14f-17d0082c38b1.png alt=image></p><p>If you are using any non Chrome, Safari or Firefox browser you need to indicate
that you don&rsquo;t want to be warned if things don&rsquo;t work as expected (note: Edge
works fine!).</p><p><img src=https://user-images.githubusercontent.com/4021595/157341388-d1a70845-ada5-4b0a-8fd9-a307f0c698ae.png alt=image></p><p>If everything is complete you should see this.</p><p><img src=https://user-images.githubusercontent.com/4021595/157341435-4f604137-78f8-46e0-8fbb-a3113f4fac65.png alt=image></p><p>You should now be able to select your Compartment (which should be named like your
project) and start using resources.</p><p><img src=https://user-images.githubusercontent.com/4021595/157345820-81a62c95-5603-4bf7-a266-0991fbd9dcb9.png alt=image></p><p>Always make sure to select your compartment - otherwise you cannot see or create
resources.</p><p>Happy computing :)</p></div><div class=td-content style=page-break-before:always><h1 id=pg-c917c05dab90d67a2e13944aefd1eb9d>2 - Object Storage</h1><div class=lead>Object Storage</div><h2 id=overview>Overview</h2><p>Object Storage is like Dropbox &mldr; it allows you to simply
store files and they can be accessible via links on the web (or APIs) and you
don&rsquo;t have to monitor the size of the disk (as opposed to block storage) and it
comes with very nice features for mirroring your data to other regions or
tiering data (making it cheaper if files are not accessed very often).</p><h2 id=setup-a-new-bucket>Setup a new Bucket</h2><p>Select a Region from the list where you want your files to be located:</p><p><img src=https://user-images.githubusercontent.com/4021595/161411496-e142dfdc-b84d-4e67-9ea0-71bc74a3f157.png alt=image></p><p>Then search for <code>Buckets</code> and you will find it under <code>Storage</code> -> <code>Object Storage & Archival Storage</code> -> Buckets:
<img src=https://user-images.githubusercontent.com/4021595/161411526-7e47aa08-5284-4d21-b3bb-9501f34a29fa.png alt=image></p><p>Select your project&rsquo;s compartment:
<img src=https://user-images.githubusercontent.com/4021595/161411532-efc61a06-e927-4f09-bfcb-ca777a2eb259.png alt=image></p><p>Create a new Bucket:</p><ul><li>give it a name</li><li>In addition to the defaults we recommend <code>Enable Auto-Tiering</code> (this will make the storage cheaper by moving objects to lower tier storage if they are not used frequently) and <code>Uncommitted Multipart Uploads Cleanup</code> (this will clean up in case uploads failed halfway)</li></ul><p><img src=https://user-images.githubusercontent.com/4021595/161411600-37cf0399-2376-41cf-8dd7-cb75f7ad8a58.png alt=image></p><h2 id=uploading-files-to-a-bucket>Uploading files to a bucket</h2><p>You could upload files via the GUI in the Oracle cloud by clicking the <code>Upload</code> button:
<img src=https://user-images.githubusercontent.com/4021595/161412082-f95b1d4c-67f9-4b69-a360-fd7aab8bc508.png alt=image></p><p>You could also use tools like rclone or curl or the OCI CLI to upload files (more about these tools later)</p><h2 id=making-a-bucket-public>Making a Bucket public</h2><p>By default, the files in the bucket will not be visible to everyone. Let&rsquo;s find the URL to the file we just uploaded: Click on the 3 dots next to the file and click on <code>View Object details</code>:
<img src=https://user-images.githubusercontent.com/4021595/161412133-d4437e2b-4886-4b16-ae05-8ec2e2215dd1.png alt=image></p><p>When opening this URL, you will get this error:
<img src=https://user-images.githubusercontent.com/4021595/161412164-ed46dd79-ee10-42ea-80dc-b1a8088e38f1.png alt=image></p><p>You can either make the WHOLE bucket visible to the world or use &ldquo;Pre-Authenticated Requests&rdquo;. Let&rsquo;s start with the easy (and less control/secure) way first:</p><p>Click on <code>Edit Visibility</code> and switch to public:
<img src=https://user-images.githubusercontent.com/4021595/161412193-e3ec0171-9b0b-46f5-885e-17163b1cb8c2.png alt=image></p><p>Now the file and EVERYTHING else in the bucket are visible to EVERYONE on the internet.</p><h2 id=pre-authenticated-requests>Pre-Authenticated Requests</h2><p>Click on the three dots next to the file again and Click <code>Create Pre-Authenticated Request</code>:
<img src=https://user-images.githubusercontent.com/4021595/161412278-26bbead8-7a58-43b3-8d31-e88a892f83fa.png alt=image></p><p>This gives you more options to control access and you can also expire the access :)</p><p>And you then get a specific URL to access the file (or the bucket or the files you configured):
<img src=https://user-images.githubusercontent.com/4021595/161412301-5fe1b423-e6ed-458a-9347-fdf8e3915fe0.png alt=image></p><p>The URL will stop working when it expires or when you delete the Request. You find all requests under <code>Pre-Authenticated Requests</code> in the Resources menu:
<img src=https://user-images.githubusercontent.com/4021595/161412353-319882d3-7016-4e1b-800f-f9a77b2af0a1.png alt=image></p><h2 id=tiering>Tiering</h2><p>Lifecycle Rules allow you to control what happens with files after a certain amount of time. You can delete them or move them to Archival storage for example:
<img src=https://user-images.githubusercontent.com/4021595/161412377-63896ae5-8d02-4bfc-bf4f-e8b30010281d.png alt=image></p><h2 id=mirroring>Mirroring</h2><p>Mirroring allows you to keep the bucket up-to-date with another bucket in another region (e.g. main bucket is in Europe and the replica is in Australia). This is controlled under the <code>Replication Policy</code>.</p><p>You first need to create the target bucket in the other region and then you can configure it as a target:
<img src=https://user-images.githubusercontent.com/4021595/161412505-d64a0177-e520-46f5-86b8-f08c4e60b962.png alt=image></p><h2 id=mounting-a-bucket-inside-a-vm>Mounting a Bucket inside a VM:</h2><p>First we need to install a few things on the VM (assuming Oracle Linux here):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm
</span></span><span style=display:flex><span>sudo yum update -y
</span></span><span style=display:flex><span>sudo yum install -y epel-release
</span></span><span style=display:flex><span>sudo yum install -y redhat-lsb-core 
</span></span><span style=display:flex><span>sudo yum install -y s3fs-fuse
</span></span></code></pre></div><p>Create a new bucket as described in the beginning of this page above.</p><p>Next we need to create a <code>Customer Secret Key</code>. For this click on the user icon in the top right corner and select <code>User settings</code>.</p><img width=330 alt=image src=https://user-images.githubusercontent.com/4021595/188381438-ac9fbfdf-1fd7-4316-bc6b-374d9f6c24e2.png><p>Then in the Resources menu on the left select &ldquo;Customer Secret Keys&rdquo; and click Generate Secret Key. Give it a name and then copy the secret (it will never be shown again!). Then copy the Access Key shown in the table as well in a separate notepad.</p><img width=594 alt=image src=https://user-images.githubusercontent.com/4021595/188381774-647ea0de-0b26-452f-bb95-549862596b0a.png><p>Now you need to store these two things inside ~/.passwd-s3fs:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>echo FILL_IN_YOUR_ACCESS_KEY_HERE:FILL_IN_YOUR_SECRET_HERE &gt; ${HOME}/.passwd-s3fs
</span></span></code></pre></div><p>and then you can mount the bucket your created earlier:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>chmod 600 ${HOME}/.passwd-s3fs
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo chmod +x /usr/bin/fusermount
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo mkdir /data
</span></span><span style=display:flex><span>sudo chmod a+rwx /data
</span></span><span style=display:flex><span>s3fs FILL_IN_YOUR_BUCKET_NAME /data/ -o endpoint=eu-frankfurt-1 -o passwd_file=${HOME}/.passwd-s3fs -o url=https://froi4niecnpv.compat.objectstorage.eu-frankfurt-1.oraclecloud.com/ -onomultipart -o use_path_request_style
</span></span></code></pre></div><p>The bucket is now accessible under /data and you can almost treat it like a volume mount (but it&rsquo;s not 100% posix complient).</p><h2 id=uploading-files-using-curl>Uploading files using CURL</h2><p>To enable this you need to create a Pre-Authenticated Request which allows access to the Bucket and it allows objects read and write and Object Listing:
<img src=https://user-images.githubusercontent.com/4021595/161412582-5f0ff3c7-f207-4ca1-811f-163ef2355fd2.png alt=image></p><p>Then copy the URL, as it will never be shown again:
<img src=https://user-images.githubusercontent.com/4021595/161412595-a9d4710a-f65d-408e-a025-1208e35ba0fe.png alt=image></p><p>Now you can use curl to upload files:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>curl -v -X PUT --upload-file YOUR_FILE_HERE YOUR_PRE_AUTHENTICATED_REQUEST_URL_HERE
</span></span></code></pre></div><h2 id=uploading-files-using-rclone>Uploading files using RCLONE</h2><p>Rclone is a great tool for managing the remote file storages. To link it up with Oracles object storage you need to configure a few things (the full version is here: <a href="https://blogs.oracle.com/linux/post/using-rclone-to-copy-data-in-and-out-of-oracle-cloud-object-storage#:~:text=%20Using%20rclone%20to%20copy%20data%20in%20and,which%20Rclone%20will%20be%20used%20to...%20More%20)">https://blogs.oracle.com/linux/post/using-rclone-to-copy-data-in-and-out-of-oracle-cloud-object-storage#:~:text=%20Using%20rclone%20to%20copy%20data%20in%20and,which%20Rclone%20will%20be%20used%20to...%20More%20)</a>:</p><ol><li>The Amazon S3 Compatibility API relies on a signing key called a Customer Secret Key. You need to create this in your User&rsquo;s settings:
<img src=https://user-images.githubusercontent.com/4021595/161412892-0e9d6190-362c-41b5-9579-5f9a2371ebed.png alt=image></li></ol><p>Then Click on <code>Generate Secret Key</code> under <code>Customer Secret Keys</code>:
<img src=https://user-images.githubusercontent.com/4021595/161412964-dd036c50-834e-436f-a8d1-a44da80f29d2.png alt=image></p><p>Save the Secret Key for later:
<img src=https://user-images.githubusercontent.com/4021595/161412970-d22661cd-b549-48ff-8c33-15ba538f02d6.png alt=image></p><p>Then save the <code>Access Key</code> from the table as well.</p><ol start=2><li>Find out where your rclone config file is located:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>rclone config file
</span></span></code></pre></div><ol start=3><li>Add this to your rclone config file:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[myobjectstorage]
</span></span><span style=display:flex><span>type = s3
</span></span><span style=display:flex><span>provider = Other
</span></span><span style=display:flex><span>env_auth = false
</span></span><span style=display:flex><span>access_key_id = &lt;ACCESS KEY&gt;
</span></span><span style=display:flex><span>secret_access_key = &lt;SECRET KEY&gt;
</span></span><span style=display:flex><span>endpoint = froi4niecnpv.compat.objectstorage.&lt;REGION&gt;.oraclecloud.com
</span></span></code></pre></div><p>Replace <code>ACCESS KEY</code> and <code>SECRET KEY</code> with the ones generated earlier. Replace <code>REGION</code> with the region where the storage bucket is located (e.g. eu-frankfurt-1).</p><p>Now you can use rclone to for example list files in the bucket:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>rclone ls myobjectstorage:/test-bucket
</span></span></code></pre></div><p>or you can upload files or whole directories (or download by reversing the order of Target/Source):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>rclone copy YOURFILE_or_YOURDIRECTORY myobjectstorage:/test-bucket
</span></span></code></pre></div><p>or you can sync whole directories or other remote storage locations (includes deletes!):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>rclone sync YOURDIRECTORY_OR_YOUR_OTHER_RCLONE_STORAGE myobjectstorage:/test-bucket
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-f6f02481d5d016336867b24121bda257>3 - Tenancy Explorer</h1><div class=lead>Tenancy Explorer</div><h2 id=overview>Overview</h2><p>The Tenancy Explorer is very useful to see what resources are currently being
used in your project.</p><p>It&rsquo;s in <code>Governance -> Tenancy Explorer</code></p><p><img src=https://user-images.githubusercontent.com/4021595/157352815-7ca0f88c-d2e1-4ca3-8d1b-f7917423a173.png alt=image></p><p>You can use this to clean up resources that are no longer required.</p><p>Hint: The network setup creates a lot of things and to cleanup it&rsquo;s easiest to
go to <code>Virtual Cloud Networks</code>, select the VCN you don&rsquo;t need anymore and click
<code>Terminate</code> - this will go out and remove everything correctly:</p><p><img src=https://user-images.githubusercontent.com/4021595/157353107-5a3a8063-189a-49c3-9c85-24b6bba52c13.png alt=image></p></div><div class=td-content style=page-break-before:always><h1 id=pg-dde96463ad5c157f426c31ea5b3bf8d8>4 - Installing and Using Docker</h1><div class=lead>Installing and using Docker</div><h2 id=overview>Overview</h2><p>Docker (or a software container in general) is great for reproducibility and making it easy to move your tools in and out of the cloud. If you don&rsquo;t know what containers are, here is a 3 minute explanation: <a href="https://www.youtube.com/watch?v=HelrQnm3v4g">https://www.youtube.com/watch?v=HelrQnm3v4g</a></p><p>You can either install the original &ldquo;Docker&rdquo; or a drop-in replacement called &ldquo;Podman&rdquo;</p><h2 id=installing-docker>Installing Docker</h2><p>Docker is not installed by default on Oracle Linux and these steps will install and start Docker:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo dnf install dnf-utils zip unzip
</span></span><span style=display:flex><span>sudo dnf config-manager --add-repo=https://download.docker.com/linux/centos/docker-ce.repo
</span></span><span style=display:flex><span>sudo dnf install docker-ce --nobest
</span></span><span style=display:flex><span>sudo systemctl enable docker.service
</span></span><span style=display:flex><span>sudo systemctl start docker.service
</span></span></code></pre></div><h2 id=or-installing-podman-instead-of-docker>OR: Installing Podman instead of Docker</h2><p>Podman is compatible with docker and is the default in Oracle Linux (and some argue it&rsquo;s even better). This is how to install podman:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo yum install docker
</span></span></code></pre></div><p>Yes: This is actually installing podman in Oracle Linux!</p><p>Or the direct way:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo yum install podman
</span></span></code></pre></div><p>If you installed podman using <code>sudo yum install docker</code> you can run docker commands directly, but it will tell you that this is actually podman:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>docker
</span></span></code></pre></div><p><img src=https://user-images.githubusercontent.com/4021595/160227312-43836181-cd0c-4d26-bc18-9ccc9fb0f700.png alt=image></p><p>Let&rsquo;s remove that msg:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo touch /etc/containers/nodocker
</span></span></code></pre></div><p>Now we have podman installed as &ldquo;docker&rdquo; drop-in replacement and we can test it:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>docker run hello-world
</span></span></code></pre></div><p><img src=https://user-images.githubusercontent.com/4021595/160227372-0012e396-a2ca-4f80-8455-d4b2c8616b19.png alt=image></p><p>and we could now run everything we like, e.g. <a href=https://neurodesk.github.io/docs/neurodesktop/getting-started/linux/>https://neurodesk.github.io/docs/neurodesktop/getting-started/linux/</a></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>mkdir /home/opc/neurodesktop-storage
</span></span><span style=display:flex><span>sudo yum install tmux
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>tmux new -s neurodesk
</span></span><span style=display:flex><span>sudo docker run \
</span></span><span style=display:flex><span>  --shm-size=1gb -it --privileged --name neurodesktop \
</span></span><span style=display:flex><span>  -v ~/neurodesktop-storage:/neurodesktop-storage \
</span></span><span style=display:flex><span>  -e HOST_UID=&#34;$(id -u)&#34; -e HOST_GID=&#34;$(id -g)&#34;\
</span></span><span style=display:flex><span>  -p 8080:8080 \
</span></span><span style=display:flex><span>  -h neurodesktop-20220302 docker.io/vnmd/neurodesktop:20220329
</span></span></code></pre></div><p>Hit CTRL-b and then d to detach from the tmux session (re-attaching is possible using <code>tmux attach-session -t neurodesk</code>).</p><p>and this is how easy it is to run a container on the cloud :)</p><p>if you connect to your cloud instance using a port-forwarding <code>ssh -L 8080:127.0.0.1:8080 opc@xxx.xx.xx.xx</code> then you could now use Neurodesktop via visiting http://localhost:8080/#/?username=user&amp;password=password in your local browser. When done, stop the container with CTRL-C and run <code>sudo docker rm neurodesktop</code> to cleanup.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-34f20b9d4a0c4334831e060dbcb10552>5 - Kubernetes</h1><div class=lead>A description how to get started with Kubernetes on Oracle Cloud</div><h2 id=overview>Overview</h2><p>Kubernetes enables running and orchestrating multiple software containers.</p><h2 id=setup-kubernetes-cluster-on-oracle-cloud-using-oke>Setup Kubernetes Cluster on Oracle Cloud using OKE</h2><p>Search for <code>OKE</code> in the menu and then go to <code>Kubernetes Clusters (OKE)</code> under <code>Containers & Artifacts</code>:
<img src=https://user-images.githubusercontent.com/4021595/164392430-231652d9-abf3-4cc0-ac90-4b2dd5c000ea.png alt=image></p><p>Select the region where you would like to create the Cluster:
<img src=https://user-images.githubusercontent.com/4021595/164392545-765fc2bd-50c1-460f-9615-213b81d3ae54.png alt=image></p><p>Select the compartment where you would like to create the Cluster:
<img src=https://user-images.githubusercontent.com/4021595/164392623-6bfc0561-7d6c-4e32-aa70-fef8259961bc.png alt=image></p><p><code>Quick Create</code> is great and gives a good starting point that works for most applications:
<img src=https://user-images.githubusercontent.com/4021595/164392731-1f23834c-9be3-40f8-b2c9-24ea65c13fc4.png alt=image></p><p>The defaults are sensible, but Public Workers make it easier to troubleshoot things in the beginning:
<img src=https://user-images.githubusercontent.com/4021595/164392860-eb050636-e820-46e2-a98a-cfdaf45a9281.png alt=image></p><p>Select the shape you like and 1 worker is good to start (can be increased and changed later!)
<img src=https://user-images.githubusercontent.com/4021595/164393030-561bf2d1-1af2-408b-9e38-51802efdd976.png alt=image></p><p>Under advanced you can configure the boot-volume size:
<img src=https://user-images.githubusercontent.com/4021595/164393130-65e48e2e-605f-4d6f-9fe3-78518fba0d14.png alt=image></p><p>Add an SSH key for troubleshooting worker nodes:
<img src=https://user-images.githubusercontent.com/4021595/164393220-77da1837-5407-476c-a971-1b3dc69b3d14.png alt=image></p><p>Review everything and then hit <code>Create</code> and it should go and set-up everything :)
<img src=https://user-images.githubusercontent.com/4021595/164393349-2b34f99a-5ea0-462e-95c4-4dd2f6d7c16e.png alt=image></p><p>That&rsquo;s how easy it can be to setup a whole Kubernetes cluster :) Thanks OCI team for creating OKE!
<img src=https://user-images.githubusercontent.com/4021595/164393450-1abc92f1-7dad-4e77-a5b5-0c72e7b0c08f.png alt=image></p><p>It will take a few minutes until everything is up and running -> Coffee break?</p><p>Once everything is ready:
<img src=https://user-images.githubusercontent.com/4021595/164396586-28f044db-f7fa-45f9-a454-ce47b41b3255.png alt=image></p><p>you can access the cluster and the settings are given when clicking <code>Access Cluster</code>:
<img src=https://user-images.githubusercontent.com/4021595/164396652-d56916ae-c822-4a03-a0de-471ffc550599.png alt=image></p><h2 id=customizing-nodes-using-init-scripts>Customizing nodes using Init-scripts</h2><p>If you configured Public IP addresses for the worker nodes, then you can connect to the nodes for troubleshooting - Click on the node under <code>Nodes</code> -> <code>pool1</code>:
<img src=https://user-images.githubusercontent.com/4021595/164403035-67eebf45-82a2-4627-8461-457e63ad0468.png alt=image></p><p>By default the disks are NOT expanded to the Bootvolume size you configured, so this can be fixed via init scripts. Edit the node pool and under advanced set the inits script:
<img src=https://user-images.githubusercontent.com/4021595/164403545-b43aca42-6185-4713-8faa-0a02762ad5b7.png alt=image></p><p>This script will expand the disk:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>curl --fail -H <span style=color:#4e9a06>&#34;Authorization: Bearer Oracle&#34;</span> -L0 http://169.254.169.254/opc/v2/instance/metadata/oke_init_script <span style=color:#000;font-weight:700>|</span> base64 --decode &gt;/var/run/oke-init.sh
</span></span><span style=display:flex><span>bash /var/run/oke-init.sh
</span></span><span style=display:flex><span>sudo dd <span style=color:#000>iflag</span><span style=color:#ce5c00;font-weight:700>=</span>direct <span style=color:#204a87;font-weight:700>if</span><span style=color:#ce5c00;font-weight:700>=</span>/dev/oracleoci/oraclevda <span style=color:#000>of</span><span style=color:#ce5c00;font-weight:700>=</span>/dev/null <span style=color:#000>count</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span><span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;1&#34;</span> <span style=color:#000;font-weight:700>|</span> sudo tee /sys/class/block/<span style=color:#4e9a06>`</span>readlink /dev/oracleoci/oraclevda <span style=color:#000;font-weight:700>|</span> cut -d<span style=color:#4e9a06>&#39;/&#39;</span> -f 2<span style=color:#4e9a06>`</span>/device/rescan
</span></span><span style=display:flex><span>sudo /usr/libexec/oci-growfs -y
</span></span></code></pre></div><p>Then hit <code>Save Changes</code>. To apply these configuration changes you need to Scale the pool to 0 and then backup to 1:
<img src=https://user-images.githubusercontent.com/4021595/164403744-30b40a8a-1e3a-428d-9a7e-14e7a3414d33.png alt=image></p><h2 id=cleanup>Cleanup</h2><p>You can delete the whole cluster to cleanup:
<img src=https://user-images.githubusercontent.com/4021595/164403933-41d231a9-e157-4dca-b770-e0d903813f8c.png alt=image></p><p>But be aware that Kubernetes can create resources via API calls, which is great, but it also means that these additionally created resources (like load balancers or storage volumes) will NOT be cleaned up automatically and need to cleaned up manually!</p></div></main></div></div><footer class="bg-dark py-4 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2 my-auto"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label><a class=text-white target=_blank rel=noopener href aria-label><i></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://twitter.com/brainhackorg aria-label=Twitter><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label><a class=text-white target=_blank rel=noopener href aria-label><i></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3 my-auto"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/brainhackorg/brainhack_cloud aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label><a class=text-white target=_blank rel=noopener href aria-label><i></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Dicussion Forum (requires github login)" aria-label="Dicussion Forum (requires github login)"><a class=text-white target=_blank rel=noopener href=https://github.com/brainhackorg/brainhack_cloud/discussions aria-label="Dicussion Forum (requires github login)"><i class="fa fa-envelope"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2 my-auto"><small class=text-white>&copy; 2023 Brainhack Cloud<br>Except where otherwise noted, content on this site is licensed under a <a href=https://creativecommons.org/licenses/by/4.0/>CC BY 4.0 license</a>.</small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/brainhack_cloud/js/main.min.0d626687ffb089f2a85c2441d596cc7e2218d32716e3a26b4623c159ada50846.js integrity="sha256-DWJmh/+wifKoXCRB1ZbMfiIY0ycW46JrRiPBWa2lCEY=" crossorigin=anonymous></script>
<script src=/js/prism.js></script></body></html>